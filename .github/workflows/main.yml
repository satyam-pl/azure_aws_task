name: Deploy Java Web App

on:
  workflow_dispatch: # Manually triggered workflow

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Ask for Cloud Provider
        id: provider
        run: |
          echo "Which cloud provider do you want to use?"
          read -p "Enter 'aws' or 'azure': " selected_provider
          echo "::set-output name=provider::$selected_provider"

      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Setup Terraform
        uses: hashicorp/setup-terraform@v1

      - name: Terraform Init & Apply
        run: |
          provider=${{ steps.provider.outputs.provider }}
          if [ "$provider" = "aws" ]; then
            cd aws
          elif [ "$provider" = "azure" ]; then
            cd azure
          else
            echo "Invalid provider selected. Please choose 'aws' or 'azure'."
            exit 1
          fi
          terraform init
          terraform apply -auto-approve
        working-directory: ${{ steps.provider.outputs.provider }}

      # Add steps for deploying the Java web app to the provisioned infrastructure
      # This could involve using build tools, deployment scripts, etc., specific to your Java application and infrastructure.
